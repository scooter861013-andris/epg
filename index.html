<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Id≈ëj√°r√°s</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: monospace;
      background: #ffffff;
      color: #000;
      padding: 16px;
      white-space: pre-line;
    }
  </style>
</head>
<body id="out">
Bet√∂lt√©s...
<script>
const lat = 47.6881;   // Hajd√∫hadh√°z
const lon = 21.6601;

// NAPPALI ikon + sz√∂veg
const weatherMap = {
  0: ["Tiszta √©gbolt", "‚òÄÔ∏è"],
  1: ["Der√ºlt", "üå§Ô∏è"],
  2: ["R√©szben felh≈ës", "‚õÖ"],
  3: ["Borult", "‚òÅÔ∏è"],
  45: ["K√∂d", "üå´Ô∏è"],
  48: ["Z√∫zmar√°s k√∂d", "üå´Ô∏è"],
  51: ["Szit√°l√°s", "üå¶Ô∏è"],
  53: ["Szit√°l√°s", "üå¶Ô∏è"],
  55: ["Er≈ës szit√°l√°s", "üåßÔ∏è"],
  61: ["Es≈ë", "üåßÔ∏è"],
  63: ["Es≈ë", "üåßÔ∏è"],
  65: ["Er≈ës es≈ë", "üåßÔ∏è"],
  71: ["Havaz√°s", "‚ùÑÔ∏è"],
  73: ["Havaz√°s", "‚ùÑÔ∏è"],
  75: ["Er≈ës havaz√°s", "‚ùÑÔ∏è"],
  80: ["Z√°por", "üåßÔ∏è"],
  81: ["Z√°por", "üåßÔ∏è"],
  82: ["Heves z√°por", "üåßÔ∏è"],
  95: ["Zivatar", "‚õàÔ∏è"]
};

// √âJSZAKAI ikonok
const nightIcons = {
  0: "üåô",      // tiszta
  1: "üåô",      // der√ºlt
  2: "‚òÅÔ∏èüåô",    // r√©szben felh≈ës
  3: "‚òÅÔ∏è",      // borult
  45: "üå´Ô∏è",
  48: "üå´Ô∏è",
  51: "üåßÔ∏è",
  53: "üåßÔ∏è",
  55: "üåßÔ∏è",
  61: "üåßÔ∏è",
  63: "üåßÔ∏è",
  65: "üåßÔ∏è",
  71: "‚ùÑÔ∏è",
  73: "‚ùÑÔ∏è",
  75: "‚ùÑÔ∏è",
  80: "üåßÔ∏è",
  81: "üåßÔ∏è",
  82: "üåßÔ∏è",
  95: "‚õàÔ∏è"
};

function dayName(dateStr) {
  return new Date(dateStr).toLocaleDateString("hu-HU", { weekday: "short" });
}

fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&daily=weathercode,temperature_2m_min,temperature_2m_max&timezone=Europe/Budapest`)
.then(r => r.json())
.then(d => {
  const now = d.current_weather;
  const map = weatherMap[now.weathercode] || ["Ismeretlen", "‚ùì"];

  // √âJSZAKA MEGHAT√ÅROZ√ÅSA (emberi logika)
  const hour = parseInt(now.time.slice(11,13), 10);
  const isNight = (hour < 6 || hour >= 16);

  let icon = map[1];
  if (isNight && nightIcons[now.weathercode]) {
    icon = nightIcons[now.weathercode];
  }

  let txt = `[${now.time.slice(11,16)}]\n`;
  txt += `Most: ${now.temperature} ¬∞C\n`;
  txt += `Id≈ë: ${map[0]} ${icon}\n\n`;
  txt += `7 napos el≈ërejelz√©s:\n`;

  for (let i = 0; i < 7; i++) {
    const dayMap = weatherMap[d.daily.weathercode[i]] || ["?", "‚ùì"];
    txt += `${dayName(d.daily.time[i])}  `;
    txt += `${Math.round(d.daily.temperature_2m_min[i])} / `;
    txt += `${Math.round(d.daily.temperature_2m_max[i])} ¬∞C `;
    txt += `${dayMap[1]}\n`;
  }

  document.getElementById("out").textContent = txt;
})
.catch(() => {
  document.getElementById("out").textContent = "Hiba az id≈ëj√°r√°s bet√∂lt√©sekor.";
});
</script>
</body>
</html>
